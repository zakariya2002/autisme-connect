â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GUIDE COMPLET : CRÃ‰ER LES POLITIQUES DE STOCKAGE POUR LES CVS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : ALLER SUR LA PAGE STORAGE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Ouvrez votre navigateur
2. Allez sur cette URL exacte :
   https://supabase.com/dashboard/project/ghfymwjclzacriswqxme/storage/buckets

3. Vous verrez une liste de "buckets" (dossiers)
4. Cherchez le bucket nommÃ© "documents"
5. Cliquez sur "documents" pour l'ouvrir


Ã‰TAPE 2 : ACCÃ‰DER AUX POLICIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Une fois dans le bucket "documents"
2. En haut, vous verrez des onglets : Objects | Policies | Configuration
3. Cliquez sur l'onglet "Policies"
4. Vous verrez un bouton "New Policy" ou "+ New policy"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAINTENANT, CRÃ‰EZ LES 4 POLITIQUES UNE PAR UNE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POLITIQUE 1/4 : UPLOAD (INSERT)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Cliquez sur "New Policy"
2. Si on vous demande un template, choisissez "Custom" ou "Create a policy"
3. Remplissez les champs :

   Policy name:
   â†“
   Educators can upload their CV

   Allowed operation:
   â†“
   Cochez uniquement : INSERT

   Target roles:
   â†“
   SÃ©lectionnez : authenticated

   Policy definition (USING expression ou WITH CHECK):
   â†“
   Copiez-collez EXACTEMENT ceci (tout sur une ligne):

bucket_id = 'documents' AND (storage.foldername(name))[1] = 'educator-cvs' AND auth.uid() IN (SELECT user_id FROM educator_profiles WHERE id::text = (storage.foldername(name))[2])

4. Cliquez sur "Save" ou "Create policy"
5. Attendez que la politique soit crÃ©Ã©e (vous devriez la voir dans la liste)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POLITIQUE 2/4 : UPDATE (UPDATE)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Cliquez Ã  nouveau sur "New Policy"
2. Remplissez :

   Policy name:
   â†“
   Educators can update their CV

   Allowed operation:
   â†“
   Cochez uniquement : UPDATE

   Target roles:
   â†“
   SÃ©lectionnez : authenticated

   Policy definition (USING expression):
   â†“
   Copiez-collez EXACTEMENT ceci :

bucket_id = 'documents' AND (storage.foldername(name))[1] = 'educator-cvs' AND auth.uid() IN (SELECT user_id FROM educator_profiles WHERE id::text = (storage.foldername(name))[2])

3. Cliquez sur "Save"


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POLITIQUE 3/4 : DELETE (DELETE)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Cliquez sur "New Policy"
2. Remplissez :

   Policy name:
   â†“
   Educators can delete their CV

   Allowed operation:
   â†“
   Cochez uniquement : DELETE

   Target roles:
   â†“
   SÃ©lectionnez : authenticated

   Policy definition (USING expression):
   â†“
   Copiez-collez EXACTEMENT ceci :

bucket_id = 'documents' AND (storage.foldername(name))[1] = 'educator-cvs' AND auth.uid() IN (SELECT user_id FROM educator_profiles WHERE id::text = (storage.foldername(name))[2])

3. Cliquez sur "Save"


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POLITIQUE 4/4 : VIEW (SELECT)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Cliquez sur "New Policy"
2. Remplissez :

   Policy name:
   â†“
   Anyone can view educator CVs

   Allowed operation:
   â†“
   Cochez uniquement : SELECT

   Target roles:
   â†“
   SÃ©lectionnez : public
   OU cochez la case "Allow public access" si disponible

   Policy definition (USING expression):
   â†“
   Copiez-collez EXACTEMENT ceci :

bucket_id = 'documents' AND (storage.foldername(name))[1] = 'educator-cvs'

3. Cliquez sur "Save"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VÃ‰RIFICATION FINALE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AprÃ¨s avoir crÃ©Ã© les 4 politiques, vous devriez voir dans la liste :

âœ“ Educators can upload their CV (INSERT)
âœ“ Educators can update their CV (UPDATE)
âœ“ Educators can delete their CV (DELETE)
âœ“ Anyone can view educator CVs (SELECT)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TESTER L'UPLOAD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Allez sur : http://localhost:3000/dashboard/educator/profile
2. Faites dÃ©filer jusqu'Ã  la section "CV (Curriculum Vitae)"
3. Cliquez sur "TÃ©lÃ©charger mon CV (PDF)"
4. SÃ©lectionnez votre fichier PDF
5. L'upload devrait fonctionner maintenant ! ğŸ‰


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EN CAS DE PROBLÃˆME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si l'erreur persiste aprÃ¨s avoir crÃ©Ã© les 4 politiques :

1. VÃ©rifiez que les 4 politiques sont bien visibles dans l'onglet Policies
2. VÃ©rifiez que vous avez bien sÃ©lectionnÃ© le bucket "documents"
3. Essayez de vous dÃ©connecter et reconnecter sur votre application
4. Videz le cache du navigateur (Ctrl+Shift+Suppr)

